{"ast":null,"code":"import _objectSpread from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Box,Pagination,PaginationItem,Stack}from\"@mui/material\";import Avatar from\"@mui/material/Avatar\";import Button from\"@mui/material/Button\";import ArrowBackIcon from\"@mui/icons-material/ArrowBack\";import ArrowForwardIcon from\"@mui/icons-material/ArrowForward\";//REDUX\nimport{useDispatch,useSelector}from\"react-redux\";import{createSelector}from\"reselect\";import{setMemberFollowings as _setMemberFollowings}from\"./slice\";import{retrieveMemberFollowings}from\"./selector\";import FollowApiService from\"../../apiServices/followApiService\";import assert from\"assert\";import{Definer}from\"../../../lib/Definer\";import{sweetErrorHandling,sweetTopSmallSuccessAlert}from\"../../../lib/sweetAlert\";import{serverApi}from\"../../../lib/config\";import{useHistory}from\"react-router-dom\";import{verifiedMemberData}from\"../../apiServices/verify\";//** REDUX SLICE */\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var actionDispatch=function actionDispatch(dispatch){return{setMemberFollowings:function setMemberFollowings(data){return dispatch(_setMemberFollowings(data));}};};/** REDUX SELECTOR */var memberFollowingsRetriever=createSelector(retrieveMemberFollowings,function(memberFollowings){return{memberFollowings:memberFollowings};});var followings=[{mb_nick:\"leo\"},{mb_nick:\"sevara\"},{mb_nick:\"lola\"}];export function MemberFollowing(props){// INITIALIZATIONS\nvar history=useHistory();var mb_id=props.mb_id,followRebuild=props.followRebuild,setFollowRebuild=props.setFollowRebuild;var _actionDispatch=actionDispatch(useDispatch()),setMemberFollowings=_actionDispatch.setMemberFollowings;var _useSelector=useSelector(memberFollowingsRetriever),memberFollowings=_useSelector.memberFollowings;var _useState=useState({page:1,limit:5,mb_id:mb_id}),_useState2=_slicedToArray(_useState,2),followingsSearchObj=_useState2[0],SetFollowingsSearchObj=_useState2[1];useEffect(function(){var followService=new FollowApiService();followService.getMemberFollowings(followingsSearchObj).then(function(data){return setMemberFollowings(data);}).catch(function(err){return console.log(err);});},[followingsSearchObj,followRebuild]);/** HANDLERS */var unsubscribeHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e,id){var followService;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;e.stopPropagation();assert.ok(verifiedMemberData,Definer.auth_err1);followService=new FollowApiService();_context.next=6;return followService.unsubscribe(id);case 6:_context.next=8;return sweetTopSmallSuccessAlert(\"unsubscribed successfully\",700,false);case 8:setFollowRebuild(!followRebuild);_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);sweetErrorHandling(_context.t0).then();case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function unsubscribeHandler(_x,_x2){return _ref.apply(this,arguments);};}();var handlePaginationChange=function handlePaginationChange(event,value){followingsSearchObj.page=value;SetFollowingsSearchObj(_objectSpread({},followingsSearchObj));};var visitMemberHandler=function visitMemberHandler(mb_id){history.push(\"/member-page/other?mb_id=\".concat(mb_id));document.location.reload();};return/*#__PURE__*/_jsxs(Stack,{children:[memberFollowings.map(function(following){var _following$follow_mem,_following$follow_mem2,_following$follow_mem3;var image_url=following!==null&&following!==void 0&&(_following$follow_mem=following.follow_member_data)!==null&&_following$follow_mem!==void 0&&_following$follow_mem.mb_image?\"\".concat(serverApi,\"/\").concat(following.follow_member_data.mb_image):\"/auth/default_user.svg\";return/*#__PURE__*/_jsxs(Box,{className:\"follow_box\",children:[/*#__PURE__*/_jsx(Avatar,{alt:\"\",src:image_url,sx:{width:89,height:89},style:{cursor:\"pointer\"},onClick:function onClick(){return visitMemberHandler(following===null||following===void 0?void 0:following.follow_id);}}),/*#__PURE__*/_jsxs(\"div\",{style:{width:\"400px\",display:\"flex\",flexDirection:\"column\",marginLeft:\"25px\",height:\"85%\"},children:[/*#__PURE__*/_jsx(\"span\",{className:\"username_text\",children:following===null||following===void 0?void 0:(_following$follow_mem2=following.follow_member_data)===null||_following$follow_mem2===void 0?void 0:_following$follow_mem2.mb_type}),/*#__PURE__*/_jsx(\"span\",{className:\"name_text\",style:{cursor:\"pointer\"},onClick:function onClick(){return visitMemberHandler(following===null||following===void 0?void 0:following.follow_id);},children:following===null||following===void 0?void 0:(_following$follow_mem3=following.follow_member_data)===null||_following$follow_mem3===void 0?void 0:_following$follow_mem3.mb_nick})]}),props.actions_enabled&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"follow_cancel_btn\",onClick:function onClick(e){return unsubscribeHandler(e,following===null||following===void 0?void 0:following.follow_id);},children:\"Unfollow\"})]});}),/*#__PURE__*/_jsx(Stack,{sx:{my:\"40px\"},direction:\"row\",alignItems:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Box,{className:\"bottom_box\",children:/*#__PURE__*/_jsx(Pagination,{count:followingsSearchObj.page>=3?followingsSearchObj.limit+1:3,page:followingsSearchObj.page,renderItem:function renderItem(item){return/*#__PURE__*/_jsx(PaginationItem,_objectSpread(_objectSpread({components:{previous:ArrowBackIcon,next:ArrowForwardIcon}},item),{},{color:\"secondary\"}));},onChange:handlePaginationChange})})})]});}","map":{"version":3,"names":["React","useEffect","useState","Box","Pagination","PaginationItem","Stack","Avatar","Button","ArrowBackIcon","ArrowForwardIcon","useDispatch","useSelector","createSelector","setMemberFollowings","retrieveMemberFollowings","FollowApiService","assert","Definer","sweetErrorHandling","sweetTopSmallSuccessAlert","serverApi","useHistory","verifiedMemberData","actionDispatch","dispatch","data","memberFollowingsRetriever","memberFollowings","followings","mb_nick","MemberFollowing","props","history","mb_id","followRebuild","setFollowRebuild","page","limit","followingsSearchObj","SetFollowingsSearchObj","followService","getMemberFollowings","then","catch","err","console","log","unsubscribeHandler","e","id","stopPropagation","ok","auth_err1","unsubscribe","handlePaginationChange","event","value","visitMemberHandler","push","document","location","reload","map","following","image_url","follow_member_data","mb_image","width","height","cursor","follow_id","display","flexDirection","marginLeft","mb_type","actions_enabled","my","item","previous","next"],"sources":["/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/src/app/screens/MemberPage/memberFollowing.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Box, Pagination, PaginationItem, Stack } from \"@mui/material\";\nimport Avatar from \"@mui/material/Avatar\";\nimport Button from \"@mui/material/Button\";\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\n//REDUX\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createSelector } from \"reselect\";\nimport { Dispatch } from \"@reduxjs/toolkit\";\nimport { Following, FollowSearchObj } from \"../../../types/follow\";\nimport { setMemberFollowings } from \"./slice\";\nimport { retrieveMemberFollowings } from \"./selector\";\nimport FollowApiService from \"../../apiServices/followApiService\";\nimport assert from \"assert\";\nimport { Definer } from \"../../../lib/Definer\";\nimport {\n  sweetErrorHandling,\n  sweetTopSmallSuccessAlert,\n} from \"../../../lib/sweetAlert\";\nimport { serverApi } from \"../../../lib/config\";\nimport { useHistory } from \"react-router-dom\";\nimport { verifiedMemberData } from \"../../apiServices/verify\";\n\n//** REDUX SLICE */\nconst actionDispatch = (dispatch: Dispatch) => ({\n  setMemberFollowings: (data: Following[]) =>\n    dispatch(setMemberFollowings(data)),\n});\n\n/** REDUX SELECTOR */\nconst memberFollowingsRetriever = createSelector(\n  retrieveMemberFollowings,\n  (memberFollowings) => ({\n    memberFollowings,\n  })\n);\n\nconst followings = [\n  { mb_nick: \"leo\" },\n  { mb_nick: \"sevara\" },\n  { mb_nick: \"lola\" },\n];\n\nexport function MemberFollowing(props: any) {\n  // INITIALIZATIONS\n  const history = useHistory();\n  const { mb_id, followRebuild, setFollowRebuild } = props;\n  const { setMemberFollowings } = actionDispatch(useDispatch());\n  const { memberFollowings } = useSelector(memberFollowingsRetriever);\n  const [followingsSearchObj, SetFollowingsSearchObj] =\n    useState<FollowSearchObj>({\n      page: 1,\n      limit: 5,\n      mb_id: mb_id,\n    });\n\n  useEffect(() => {\n    const followService = new FollowApiService();\n    followService\n      .getMemberFollowings(followingsSearchObj)\n      .then((data) => setMemberFollowings(data))\n      .catch((err) => console.log(err));\n  }, [followingsSearchObj, followRebuild]);\n\n  /** HANDLERS */\n  const unsubscribeHandler = async (e: any, id: string) => {\n    try {\n      e.stopPropagation();\n      assert.ok(verifiedMemberData, Definer.auth_err1);\n\n      const followService = new FollowApiService();\n      await followService.unsubscribe(id);\n\n      await sweetTopSmallSuccessAlert(\"unsubscribed successfully\", 700, false);\n      setFollowRebuild(!followRebuild);\n    } catch (err: any) {\n      console.log(err);\n      sweetErrorHandling(err).then();\n    }\n  };\n\n  const handlePaginationChange = (event: any, value: number) => {\n    followingsSearchObj.page = value;\n    SetFollowingsSearchObj({ ...followingsSearchObj });\n  };\n\n  const visitMemberHandler = (mb_id: string) => {\n    history.push(`/member-page/other?mb_id=${mb_id}`);\n    document.location.reload();\n  };\n\n  return (\n    <Stack>\n      {memberFollowings.map((following: Following) => {\n        const image_url = following?.follow_member_data?.mb_image\n          ? `${serverApi}/${following.follow_member_data.mb_image}`\n          : \"/auth/default_user.svg\";\n        return (\n          <Box className={\"follow_box\"}>\n            <Avatar\n              alt={\"\"}\n              src={image_url}\n              sx={{ width: 89, height: 89 }}\n              style={{ cursor: \"pointer\" }}\n              onClick={() => visitMemberHandler(following?.follow_id)}\n            />\n            <div\n              style={{\n                width: \"400px\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                marginLeft: \"25px\",\n                height: \"85%\",\n              }}\n            >\n              <span className={\"username_text\"}>\n                {following?.follow_member_data?.mb_type}\n              </span>\n              <span\n                className={\"name_text\"}\n                style={{ cursor: \"pointer\" }}\n                onClick={() => visitMemberHandler(following?.follow_id)}\n              >\n                {following?.follow_member_data?.mb_nick}\n              </span>\n            </div>\n\n            {props.actions_enabled && (\n              <Button\n                variant={\"contained\"}\n                className={\"follow_cancel_btn\"}\n                onClick={(e) => unsubscribeHandler(e, following?.follow_id)}\n              >\n                Unfollow\n              </Button>\n            )}\n          </Box>\n        );\n      })}\n      <Stack\n        sx={{ my: \"40px\" }}\n        direction=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"center\"\n      >\n        <Box className={\"bottom_box\"}>\n          <Pagination\n            count={\n              followingsSearchObj.page >= 3 ? followingsSearchObj.limit + 1 : 3\n            }\n            page={followingsSearchObj.page}\n            renderItem={(item) => (\n              <PaginationItem\n                components={{\n                  previous: ArrowBackIcon,\n                  next: ArrowForwardIcon,\n                }}\n                {...item}\n                color={\"secondary\"}\n              />\n            )}\n            onChange={handlePaginationChange}\n          />\n        </Box>\n      </Stack>\n    </Stack>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}