{"ast":null,"code":"import _regeneratorRuntime from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Button,Stack}from\"@mui/material\";import IconButton from\"@mui/material/IconButton\";import Badge from\"@mui/material/Badge\";import Menu from\"@mui/material/Menu\";import CancelIcon from\"@mui/icons-material/Cancel\";import ShoppingCartIcon from\"@mui/icons-material/ShoppingCart\";import React from\"react\";import{serverApi}from\"../../../lib/config\";import{sweetErrorHandling}from\"../../../lib/sweetAlert\";import assert from\"assert\";import{Definer}from\"../../../lib/Definer\";import OrderApiService from\"../../apiServices/orderApiService\";import{useHistory}from\"react-router-dom\";import{verifiedMemberData}from\"../../apiServices/verify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Basket(props){/** INITIALIZATIONS **/var history=useHistory();var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),anchorEl=_React$useState2[0],setAnchorEl=_React$useState2[1];var open=Boolean(anchorEl);var cartItems=props.cartItems,onAdd=props.onAdd,onRemove=props.onRemove,onDelete=props.onDelete,onDeleteAll=props.onDeleteAll;var itemsPrice=cartItems.reduce(function(a,c){return a+c.price*c.quantity;},0);var shippingPrice=itemsPrice>100?0:2;var totalPrice=itemsPrice+shippingPrice;/** HANDLERS **/var handleClick=function handleClick(event){setAnchorEl(event.currentTarget);};var handleClose=function handleClose(){setAnchorEl(null);};var processOrderHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var order;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;assert.ok(verifiedMemberData,Definer.auth_err1);order=new OrderApiService();_context.next=5;return order.createOrder(cartItems);case 5:onDeleteAll();handleClose();props.setOrderRebuild(new Date());history.push(\"/orders\");_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);sweetErrorHandling(_context.t0).then();case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function processOrderHandler(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Box,{className:\"hover-line\",children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"cart\",id:\"basic-button\",\"aria-controls\":open?\"basic-menu\":undefined,\"aria-haspopup\":\"true\",\"aria-expanded\":open?\"true\":undefined,onClick:handleClick,children:/*#__PURE__*/_jsx(Badge,{badgeContent:cartItems.length,color:\"secondary\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/icons/shopping_cart.svg\"})})}),/*#__PURE__*/_jsx(Menu,{anchorEl:anchorEl,id:\"account-menu\",open:open,onClose:handleClose// onClick={handleClose}\n,PaperProps:{elevation:0,sx:{overflow:\"visible\",filter:\"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))\",mt:1.5,\"& .MuiAvatar-root\":{width:32,height:32,ml:-0.5,mr:1},\"&:before\":{content:'\"\"',display:\"block\",position:\"absolute\",top:0,right:14,width:10,height:10,bgcolor:\"background.paper\",transform:\"translateY(-50%) rotate(45deg)\",zIndex:0}}},transformOrigin:{horizontal:\"right\",vertical:\"top\"},anchorOrigin:{horizontal:\"right\",vertical:\"bottom\"},children:/*#__PURE__*/_jsxs(Stack,{className:\"basket_frame\",children:[/*#__PURE__*/_jsx(Box,{className:\"all_check_box\",children:false?/*#__PURE__*/_jsx(\"div\",{children:\"Cart is empty!\"}):/*#__PURE__*/_jsx(\"div\",{children:\"Products list:\"})}),/*#__PURE__*/_jsx(Box,{className:\"orders_main_wrapper\",children:/*#__PURE__*/_jsx(Box,{className:\"orders_wrapper\",children:cartItems===null||cartItems===void 0?void 0:cartItems.map(function(item){var image_path=\"\".concat(serverApi,\"/\").concat(item.image);return/*#__PURE__*/_jsxs(Box,{className:\"basket_info_box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cancel_btn\",children:/*#__PURE__*/_jsx(CancelIcon,{color:\"primary\",onClick:function onClick(){return onDelete(item);}})}),/*#__PURE__*/_jsx(\"img\",{src:image_path,className:\"product_img\"}),/*#__PURE__*/_jsx(\"span\",{className:\"product_name\",children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"product_price\",children:[\"$\",item.price,\" x \",item.quantity]}),/*#__PURE__*/_jsx(Box,{sx:{minWidth:120},children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return onRemove(item);},className:\"remove\",children:\"-\"}),\" \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return onAdd(item);},className:\"add\",children:\"+\"})]})})]});})})}),cartItems.length>0?/*#__PURE__*/_jsxs(Box,{className:\"to_order_box\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"price_text\",children:[\"Total: $\",totalPrice,\" (\",itemsPrice,\" + \",shippingPrice,\")\"]}),/*#__PURE__*/_jsx(Button,{onClick:processOrderHandler,startIcon:/*#__PURE__*/_jsx(ShoppingCartIcon,{}),variant:\"contained\",children:\"Order\"})]}):\"\"]})})]});}","map":{"version":3,"names":["Box","Button","Stack","IconButton","Badge","Menu","CancelIcon","ShoppingCartIcon","React","serverApi","sweetErrorHandling","assert","Definer","OrderApiService","useHistory","verifiedMemberData","Basket","props","history","useState","anchorEl","setAnchorEl","open","Boolean","cartItems","onAdd","onRemove","onDelete","onDeleteAll","itemsPrice","reduce","a","c","price","quantity","shippingPrice","totalPrice","handleClick","event","currentTarget","handleClose","processOrderHandler","ok","auth_err1","order","createOrder","setOrderRebuild","Date","push","console","log","then","undefined","length","elevation","sx","overflow","filter","mt","width","height","ml","mr","content","display","position","top","right","bgcolor","transform","zIndex","horizontal","vertical","map","item","image_path","image","name","minWidth"],"sources":["/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/src/app/components/header/basket.tsx"],"sourcesContent":["import { Box, Button, Stack } from \"@mui/material\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Badge from \"@mui/material/Badge\";\nimport Menu from \"@mui/material/Menu\";\nimport CancelIcon from \"@mui/icons-material/Cancel\";\nimport ShoppingCartIcon from \"@mui/icons-material/ShoppingCart\";\nimport React from \"react\";\nimport { CartItem } from \"../../../types/others\";\nimport { serverApi } from \"../../../lib/config\";\nimport { sweetErrorHandling } from \"../../../lib/sweetAlert\";\nimport assert from \"assert\";\nimport { Definer } from \"../../../lib/Definer\";\nimport OrderApiService from \"../../apiServices/orderApiService\";\nimport { useHistory } from \"react-router-dom\";\nimport { verifiedMemberData } from \"../../apiServices/verify\";\n\nexport default function Basket(props: any) {\n  /** INITIALIZATIONS **/\n  const history = useHistory();\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n  const open = Boolean(anchorEl);\n\n  const { cartItems, onAdd, onRemove, onDelete, onDeleteAll } = props;\n  const itemsPrice = cartItems.reduce(\n    (a: any, c: CartItem) => a + c.price * c.quantity,\n    0\n  );\n  const shippingPrice = itemsPrice > 100 ? 0 : 2;\n  const totalPrice = itemsPrice + shippingPrice;\n\n  /** HANDLERS **/\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const processOrderHandler = async () => {\n    try {\n      assert.ok(verifiedMemberData, Definer.auth_err1);\n      const order = new OrderApiService();\n      await order.createOrder(cartItems);\n\n      onDeleteAll();\n      handleClose();\n\n      props.setOrderRebuild(new Date());\n      history.push(\"/orders\");\n    } catch (err: any) {\n      console.log(err);\n      sweetErrorHandling(err).then();\n    }\n  };\n\n  return (\n    <Box className={\"hover-line\"}>\n      <IconButton\n        aria-label=\"cart\"\n        id=\"basic-button\"\n        aria-controls={open ? \"basic-menu\" : undefined}\n        aria-haspopup=\"true\"\n        aria-expanded={open ? \"true\" : undefined}\n        onClick={handleClick}\n      >\n        <Badge badgeContent={cartItems.length} color=\"secondary\">\n          <img src={\"/icons/shopping_cart.svg\"} />\n        </Badge>\n      </IconButton>\n      <Menu\n        anchorEl={anchorEl}\n        id=\"account-menu\"\n        open={open}\n        onClose={handleClose}\n        // onClick={handleClose}\n        PaperProps={{\n          elevation: 0,\n          sx: {\n            overflow: \"visible\",\n            filter: \"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))\",\n            mt: 1.5,\n            \"& .MuiAvatar-root\": {\n              width: 32,\n              height: 32,\n              ml: -0.5,\n              mr: 1,\n            },\n            \"&:before\": {\n              content: '\"\"',\n              display: \"block\",\n              position: \"absolute\",\n              top: 0,\n              right: 14,\n              width: 10,\n              height: 10,\n              bgcolor: \"background.paper\",\n              transform: \"translateY(-50%) rotate(45deg)\",\n              zIndex: 0,\n            },\n          },\n        }}\n        transformOrigin={{ horizontal: \"right\", vertical: \"top\" }}\n        anchorOrigin={{ horizontal: \"right\", vertical: \"bottom\" }}\n      >\n        <Stack className={\"basket_frame\"}>\n          <Box className={\"all_check_box\"}>\n            {false ? <div>Cart is empty!</div> : <div>Products list:</div>}\n          </Box>\n\n          <Box className={\"orders_main_wrapper\"}>\n            <Box className={\"orders_wrapper\"}>\n              {cartItems?.map((item: CartItem) => {\n                const image_path = `${serverApi}/${item.image}`;\n                return (\n                  <Box className={\"basket_info_box\"}>\n                    <div className={\"cancel_btn\"}>\n                      <CancelIcon\n                        color={\"primary\"}\n                        onClick={() => onDelete(item)}\n                      />\n                    </div>\n                    <img src={image_path} className={\"product_img\"} />\n                    <span className={\"product_name\"}>{item.name}</span>\n                    <p className={\"product_price\"}>\n                      ${item.price} x {item.quantity}\n                    </p>\n                    <Box sx={{ minWidth: 120 }}>\n                      <div className=\"col-2\">\n                        <button\n                          onClick={() => onRemove(item)}\n                          className=\"remove\"\n                        >\n                          -\n                        </button>{\" \"}\n                        <button onClick={() => onAdd(item)} className=\"add\">\n                          +\n                        </button>\n                      </div>\n                    </Box>\n                  </Box>\n                );\n              })}\n            </Box>\n          </Box>\n          {cartItems.length > 0 ? (\n            <Box className={\"to_order_box\"}>\n              <span className={\"price_text\"}>\n                Total: ${totalPrice} ({itemsPrice} + {shippingPrice})\n              </span>\n              <Button\n                onClick={processOrderHandler}\n                startIcon={<ShoppingCartIcon />}\n                variant={\"contained\"}\n              >\n                Order\n              </Button>\n            </Box>\n          ) : (\n            \"\"\n          )}\n        </Stack>\n      </Menu>\n    </Box>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}