{"ast":null,"code":"import _objectSpread from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Box,Pagination,PaginationItem,Stack}from\"@mui/material\";import Avatar from\"@mui/material/Avatar\";import Button from\"@mui/material/Button\";import ArrowBackIcon from\"@mui/icons-material/ArrowBack\";import ArrowForwardIcon from\"@mui/icons-material/ArrowForward\";import{setMemberFollowers as _setMemberFollowers}from\"../../../app/screens/MemberPage/slice\";import{retrieveMemberFollowers}from\"../../../app/screens/MemberPage/selector\";import FollowApiService from\"../../apiServices/followApiService\";import{serverApi}from\"../../../lib/config\";import assert from\"assert\";import{Definer}from\"../../../lib/Definer\";import{sweetErrorHandling,sweetTopSmallSuccessAlert}from\"../../../lib/sweetAlert\";//REDUX\nimport{useDispatch,useSelector}from\"react-redux\";import{createSelector}from\"reselect\";import{useHistory}from\"react-router-dom\";import{verifiedMemberData}from\"../../apiServices/verify\";//** REDUX SLICE */\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var actionDispatch=function actionDispatch(dispatch){return{setMemberFollowers:function setMemberFollowers(data){return dispatch(_setMemberFollowers(data));}};};/** REDUX SELECTOR */var memberFollowersRetriever=createSelector(retrieveMemberFollowers,function(memberFollowers){return{memberFollowers:memberFollowers};});export function MemberFollowers(props){// INITIALIZATIONS\nvar history=useHistory();var followRebuild=props.followRebuild,setFollowRebuild=props.setFollowRebuild,mb_id=props.mb_id;var _actionDispatch=actionDispatch(useDispatch()),setMemberFollowers=_actionDispatch.setMemberFollowers;var _useSelector=useSelector(memberFollowersRetriever),memberFollowers=_useSelector.memberFollowers;var _useState=useState({page:1,limit:5,mb_id:mb_id}),_useState2=_slicedToArray(_useState,2),followersSearchObj=_useState2[0],SetFollowersSearchObj=_useState2[1];useEffect(function(){var followService=new FollowApiService();followService.getMemberFollowers(followersSearchObj).then(function(data){return setMemberFollowers(data);}).catch(function(err){return console.log(err);});},[followersSearchObj,followRebuild]);/** HANDLERS */var subscribeHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e,id){var followService;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;e.stopPropagation();assert.ok(verifiedMemberData,Definer.auth_err1);followService=new FollowApiService();_context.next=6;return followService.subscribe(id);case 6:_context.next=8;return sweetTopSmallSuccessAlert(\"subscribed successfully\",700,false);case 8:setFollowRebuild(!followRebuild);_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);sweetErrorHandling(_context.t0).then();case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function subscribeHandler(_x,_x2){return _ref.apply(this,arguments);};}();var handlePaginationChange=function handlePaginationChange(event,value){followersSearchObj.page=value;SetFollowersSearchObj(_objectSpread({},followersSearchObj));};var visitMemberHandler=function visitMemberHandler(mb_id){history.push(\"/member-page/other?mb_id=\".concat(mb_id));document.location.reload();};return/*#__PURE__*/_jsxs(Stack,{children:[memberFollowers.map(function(follower){var _follower$subscriber_,_follower$subscriber_2,_follower$subscriber_3,_follower$me_followed;var image_url=follower!==null&&follower!==void 0&&(_follower$subscriber_=follower.subscriber_member_data)!==null&&_follower$subscriber_!==void 0&&_follower$subscriber_.mb_image?\"\".concat(serverApi,\"/\").concat(follower.subscriber_member_data.mb_image):\"/auth/default_user.svg\";return/*#__PURE__*/_jsxs(Box,{className:\"follow_box\",children:[/*#__PURE__*/_jsx(Avatar,{style:{cursor:\"pointer\"},alt:\"\",src:image_url,sx:{width:89,height:89},onClick:function onClick(){return visitMemberHandler(follower===null||follower===void 0?void 0:follower.subscriber_id);}}),/*#__PURE__*/_jsxs(\"div\",{style:{width:\"400px\",display:\"flex\",flexDirection:\"column\",marginLeft:\"25px\",height:\"85%\"},children:[/*#__PURE__*/_jsx(\"span\",{className:\"username_text\",children:follower===null||follower===void 0?void 0:(_follower$subscriber_2=follower.subscriber_member_data)===null||_follower$subscriber_2===void 0?void 0:_follower$subscriber_2.mb_type}),/*#__PURE__*/_jsx(\"span\",{className:\"name_text\",style:{cursor:\"pointer\"},onClick:function onClick(){return visitMemberHandler(follower===null||follower===void 0?void 0:follower.subscriber_id);},children:follower===null||follower===void 0?void 0:(_follower$subscriber_3=follower.subscriber_member_data)===null||_follower$subscriber_3===void 0?void 0:_follower$subscriber_3.mb_nick})]}),props.actions_enabled&&(follower!==null&&follower!==void 0&&follower.me_followed&&(_follower$me_followed=follower.me_followed[0])!==null&&_follower$me_followed!==void 0&&_follower$me_followed.my_following?/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"following_already\",children:\"FOLLOWING\"}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"follow_btn\",onClick:function onClick(e){return subscribeHandler(e,follower===null||follower===void 0?void 0:follower.subscriber_id);},children:\"Follow Back\"}))]});}),/*#__PURE__*/_jsx(Stack,{sx:{my:\"40px\"},direction:\"row\",alignItems:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Box,{className:\"bottom_box\",children:/*#__PURE__*/_jsx(Pagination,{count:followersSearchObj.page>=3?followersSearchObj.limit+1:3,page:followersSearchObj.page,renderItem:function renderItem(item){return/*#__PURE__*/_jsx(PaginationItem,_objectSpread(_objectSpread({components:{previous:ArrowBackIcon,next:ArrowForwardIcon}},item),{},{color:\"secondary\"}));},onChange:handlePaginationChange})})})]});}","map":{"version":3,"names":["React","useEffect","useState","Box","Pagination","PaginationItem","Stack","Avatar","Button","ArrowBackIcon","ArrowForwardIcon","setMemberFollowers","retrieveMemberFollowers","FollowApiService","serverApi","assert","Definer","sweetErrorHandling","sweetTopSmallSuccessAlert","useDispatch","useSelector","createSelector","useHistory","verifiedMemberData","actionDispatch","dispatch","data","memberFollowersRetriever","memberFollowers","MemberFollowers","props","history","followRebuild","setFollowRebuild","mb_id","page","limit","followersSearchObj","SetFollowersSearchObj","followService","getMemberFollowers","then","catch","err","console","log","subscribeHandler","e","id","stopPropagation","ok","auth_err1","subscribe","handlePaginationChange","event","value","visitMemberHandler","push","document","location","reload","map","follower","image_url","subscriber_member_data","mb_image","cursor","width","height","subscriber_id","display","flexDirection","marginLeft","mb_type","mb_nick","actions_enabled","me_followed","my_following","my","item","previous","next"],"sources":["/Users/baxtiyoraxatov/Desktop/Desktop/ultragear-react/src/app/screens/MemberPage/memberFollowers.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Box, Pagination, PaginationItem, Stack } from \"@mui/material\";\nimport Avatar from \"@mui/material/Avatar\";\nimport Button from \"@mui/material/Button\";\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\nimport { Follower, FollowSearchObj } from \"../../../types/follow\";\nimport { setMemberFollowers } from \"../../../app/screens/MemberPage/slice\";\nimport { retrieveMemberFollowers } from \"../../../app/screens/MemberPage/selector\";\nimport FollowApiService from \"../../apiServices/followApiService\";\nimport { serverApi } from \"../../../lib/config\";\nimport assert from \"assert\";\nimport { Definer } from \"../../../lib/Definer\";\nimport {\n  sweetErrorHandling,\n  sweetTopSmallSuccessAlert,\n} from \"../../../lib/sweetAlert\";\n//REDUX\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createSelector } from \"reselect\";\nimport { Dispatch } from \"@reduxjs/toolkit\";\nimport { useHistory } from \"react-router-dom\";\nimport { verifiedMemberData } from \"../../apiServices/verify\";\n\n//** REDUX SLICE */\nconst actionDispatch = (dispatch: Dispatch) => ({\n  setMemberFollowers: (data: Follower[]) => dispatch(setMemberFollowers(data)),\n});\n\n/** REDUX SELECTOR */\nconst memberFollowersRetriever = createSelector(\n  retrieveMemberFollowers,\n  (memberFollowers) => ({\n    memberFollowers,\n  })\n);\n\nexport function MemberFollowers(props: any) {\n  // INITIALIZATIONS\n  const history = useHistory();\n  const { followRebuild, setFollowRebuild, mb_id } = props;\n  const { setMemberFollowers } = actionDispatch(useDispatch());\n  const { memberFollowers } = useSelector(memberFollowersRetriever);\n  const [followersSearchObj, SetFollowersSearchObj] = useState<FollowSearchObj>(\n    {\n      page: 1,\n      limit: 5,\n      mb_id: mb_id,\n    }\n  );\n\n  useEffect(() => {\n    const followService = new FollowApiService();\n    followService\n      .getMemberFollowers(followersSearchObj)\n      .then((data) => setMemberFollowers(data))\n      .catch((err) => console.log(err));\n  }, [followersSearchObj, followRebuild]);\n\n  /** HANDLERS */\n  const subscribeHandler = async (e: any, id: string) => {\n    try {\n      e.stopPropagation();\n      assert.ok(verifiedMemberData, Definer.auth_err1);\n\n      const followService = new FollowApiService();\n      await followService.subscribe(id);\n\n      await sweetTopSmallSuccessAlert(\"subscribed successfully\", 700, false);\n      setFollowRebuild(!followRebuild);\n    } catch (err: any) {\n      console.log(err);\n      sweetErrorHandling(err).then();\n    }\n  };\n\n  const handlePaginationChange = (event: any, value: number) => {\n    followersSearchObj.page = value;\n    SetFollowersSearchObj({ ...followersSearchObj });\n  };\n\n  const visitMemberHandler = (mb_id: string) => {\n    history.push(`/member-page/other?mb_id=${mb_id}`);\n    document.location.reload();\n  };\n\n  return (\n    <Stack>\n      {memberFollowers.map((follower: Follower) => {\n        const image_url = follower?.subscriber_member_data?.mb_image\n          ? `${serverApi}/${follower.subscriber_member_data.mb_image}`\n          : \"/auth/default_user.svg\";\n        return (\n          <Box className={\"follow_box\"}>\n            <Avatar\n              style={{ cursor: \"pointer\" }}\n              alt={\"\"}\n              src={image_url}\n              sx={{ width: 89, height: 89 }}\n              onClick={() => visitMemberHandler(follower?.subscriber_id)}\n            />\n            <div\n              style={{\n                width: \"400px\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                marginLeft: \"25px\",\n                height: \"85%\",\n              }}\n            >\n              <span className={\"username_text\"}>\n                {follower?.subscriber_member_data?.mb_type}\n              </span>\n              <span\n                className={\"name_text\"}\n                style={{ cursor: \"pointer\" }}\n                onClick={() => visitMemberHandler(follower?.subscriber_id)}\n              >\n                {follower?.subscriber_member_data?.mb_nick}\n              </span>\n            </div>\n            {props.actions_enabled &&\n              (follower?.me_followed &&\n              follower.me_followed[0]?.my_following ? (\n                <Button variant={\"contained\"} className={\"following_already\"}>\n                  FOLLOWING\n                </Button>\n              ) : (\n                <Button\n                  variant={\"contained\"}\n                  className={\"follow_btn\"}\n                  onClick={(e) => subscribeHandler(e, follower?.subscriber_id)}\n                >\n                  Follow Back\n                </Button>\n              ))}\n          </Box>\n        );\n      })}\n      <Stack\n        sx={{ my: \"40px\" }}\n        direction=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"center\"\n      >\n        <Box className={\"bottom_box\"}>\n          <Pagination\n            count={\n              followersSearchObj.page >= 3 ? followersSearchObj.limit + 1 : 3\n            }\n            page={followersSearchObj.page}\n            renderItem={(item) => (\n              <PaginationItem\n                components={{\n                  previous: ArrowBackIcon,\n                  next: ArrowForwardIcon,\n                }}\n                {...item}\n                color={\"secondary\"}\n              />\n            )}\n            onChange={handlePaginationChange}\n          />\n        </Box>\n      </Stack>\n    </Stack>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}